{% extends "base.html" %}
{% block content %}

<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>ğŸ¯ Moji klienti</h2>
        <div>
          <a href="{% url 'coaching:edit_coach' %}" class="btn btn-outline-primary">
            âš™ï¸ Upravit profil
          </a>
        </div>
      </div>

      <!-- PÅ™ehled statistik -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="card text-center">
            <div class="card-body">
              <h3 class="text-primary">{{ clients_count }}</h3>
              <p class="text-muted">Celkem klientÅ¯</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center">
            <div class="card-body">
              <h3 class="text-success">{{ active_clients }}</h3>
              <p class="text-muted">AktivnÃ­ klienti</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center">
            <div class="card-body">
              <h3 class="text-info">{{ statements_total }}</h3>
              <p class="text-muted">NahranÃ½ch vÃ½kazÅ¯</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center">
            <div class="card-body">
              <h3 class="text-warning">{{ recent_uploads }}</h3>
              <p class="text-muted">NovÃ½ch tento mÄ›sÃ­c</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Seznam klientÅ¯ -->
      <div class="card">
        <div class="card-header">
          <h5>ğŸ“‹ Seznam klientÅ¯</h5>
        </div>
        <div class="card-body">
          {% if clients %}
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Firma</th>
                    <th>IÄŒO</th>
                    <th>Kontakt</th>
                    <th>OdvÄ›tvÃ­</th>
                    <th>VÃ½kazy</th>
                    <th>PoslednÃ­ aktivita</th>
                    <th>Akce</th>
                  </tr>
                </thead>
                <tbody>
                  {% for client in clients %}
                  <tr>
                    <td>
                      <strong>{{ client.company_name }}</strong>
                      {% if client.city %}
                        <br><small class="text-muted">ğŸ“ {{ client.city }}</small>
                      {% endif %}
                    </td>
                    <td>{{ client.ico|default:"-" }}</td>
                    <td>
                      {{ client.contact_person|default:"-" }}
                      {% if client.phone %}
                        <br><small class="text-muted">ğŸ“ {{ client.phone }}</small>
                      {% endif %}
                    </td>
                    <td>{{ client.industry|default:"-" }}</td>
                    <td>
                      <span class="badge bg-{% if client.statements_count > 0 %}success{% else %}secondary{% endif %}">
                        {{ client.statements_count }} vÃ½kazÅ¯
                      </span>
                    </td>
                    <td>
                      {% if client.last_activity %}
                        {{ client.last_activity|date:"d.m.Y" }}
                      {% else %}
                        <span class="text-muted">Å½Ã¡dnÃ¡ aktivita</span>
                      {% endif %}
                    </td>
                    <td>
                      <div class="btn-group btn-group-sm">
                        <a href="{% url 'coaching:client_dashboard' client.id %}" 
                           class="btn btn-primary" title="Zobrazit dashboard klienta">
                          ğŸ“Š Dashboard
                        </a>
                        <a href="{% url 'coaching:client_documents' client.id %}" 
                           class="btn btn-outline-secondary" title="Dokumenty klienta">
                          ğŸ“„ Dokumenty
                        </a>
                        <a href="mailto:{{ client.user.email }}" 
                           class="btn btn-outline-info" title="Napsat email">
                          âœ‰ï¸
                        </a>
                      </div>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <div class="text-center py-5">
              <h4 class="text-muted">ZatÃ­m nemÃ¡te pÅ™iÅ™azenÃ© Å¾Ã¡dnÃ© klienty</h4>
              <p class="text-muted">Klienti budou pÅ™iÅ™azeni administrÃ¡torem systÃ©mu.</p>
            </div>
          {% endif %}
        </div>
      </div>

      <!-- RychlÃ© akce -->
      <div class="row mt-4">
        <div class="col-md-6">
          <div class="card">
            <div class="card-header">
              <h6>ğŸš€ RychlÃ© akce</h6>
            </div>
            <div class="card-body">
              <div class="d-grid gap-2">
                <a href="{% url 'coaching:clients_overview' %}" class="btn btn-outline-primary">
                  ğŸ“Š PÅ™ehled vÅ¡ech klientÅ¯
                </a>
                <a href="{% url 'coaching:coach_reports' %}" class="btn btn-outline-success">
                  ğŸ“ˆ Reporty a analÃ½zy
                </a>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card">
            <div class="card-header">
              <h6>ğŸ“… NedÃ¡vnÃ¡ aktivita</h6>
            </div>
            <div class="card-body">
              {% if recent_activities %}
                <ul class="list-unstyled">
                  {% for activity in recent_activities %}
                  <li class="mb-2">
                    <small class="text-muted">{{ activity.date|date:"d.m H:i" }}</small><br>
                    <strong>{{ activity.client_name }}</strong>: {{ activity.description }}
                  </li>
                  {% endfor %}
                </ul>
              {% else %}
                <p class="text-muted">Å½Ã¡dnÃ¡ nedÃ¡vnÃ¡ aktivita</p>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}