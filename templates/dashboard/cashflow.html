{% extends "base.html" %}
{% block content %}
<div class="section-shell">
  <section class="scb-panel scb-panel--inline">
    <div class="page-heading">
      <span class="page-eyebrow">Cash Flow</span>
      <h2 class="page-title">Profit vs Cash Flow</h2>
      <p class="page-subtitle">
        Porovnej účetní výsledky se skutečným tokem hotovosti a odhal rozdíly v jednotlivých kategoriích.
      </p>
    </div>

    <form method="get" class="scb-filter-group">
      <label for="year" class="filter-title">Vyber rok</label>
      <select name="year" id="year" class="form-select scb-select-inline" onchange="this.form.submit()">
        {% for y in years %}
        <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
        {% endfor %}
      </select>
    </form>

    {% if error %}
    <div class="alert alert-danger mb-0">{{ error }}</div>
    {% elif cf %}
    <div class="scb-table-scroll mt-3">
      <table class="table scb-data-table align-middle text-center">
        <thead>
          <tr>
            <th>Položka</th>
            <th>Profit</th>
            <th>Cash Flow</th>
            <th>Rozdíl</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Tržby</strong></td>
            <td>{{ cf.revenue|floatformat:0 }}</td>
            <td>{{ cf.gross_cash_profit|floatformat:0 }}</td>
            <td>{{ cf.variance.gross|floatformat:0 }}</td>
          </tr>
          <tr>
            <td><strong>Provozní zisk</strong></td>
            <td>{{ cf.operating_cash_profit|floatformat:0 }}</td>
            <td>{{ cf.operating_cash_flow|floatformat:0 }}</td>
            <td>{{ cf.variance.operating|floatformat:0 }}</td>
          </tr>
          <tr>
            <td><strong>Čistý zisk</strong></td>
            <td>{{ cf.retained_profit|floatformat:0 }}</td>
            <td>{{ cf.net_cash_flow|floatformat:0 }}</td>
            <td>{{ cf.variance.net|floatformat:0 }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="panel-subtitle mt-3 mb-0">
      Data vycházejí z nahraných finančních výkazů pro rok {{ selected_year }}.
    </p>
    {% else %}
    <div class="alert alert-warning mb-0">
      Zatím nejsou dostupná data pro zobrazení cash flow.
    </div>
    {% endif %}
  </section>
</div>
{% endblock %}
